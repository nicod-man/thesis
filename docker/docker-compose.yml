version: "3.9"

services:

    facedetection:
        image: nicodman/thesis:facedetection
        container_name: facedetection_container
        dns: 8.8.8.8
        network_mode: "host"
        stdin_open: true #docker run -i
        tty: true               #docker run -t
        environment:
            - DISPLAY=:0
        privileged: true
        devices:
            - /dev/video0:/dev/video0
        volumes:
            - $SPD_DIR/models/Real-Time-Face-Expression-Recognition:/home/robot/src/Real-Time-Face-Expression-Recognition
            - /tmp/.X11-unix:/tmp/.X11-unix:rw
        entrypoint:
            - bash
            - -ci
            - "python3 stage_fd.py --server -modelname fer"        
            
    fer:
        image: nicodman/thesis:faceExpression
        container_name: fer_container
        dns: 8.8.8.8
        network_mode: "host"
        stdin_open: true #docker run -i
        tty: true               #docker run -t
        environment:
            - DISPLAY=:0
        privileged: true
        devices:
            - /dev/video0:/dev/video0
        volumes:
            - $SPD_DIR/models/Real-Time-Face-Expression-Recognition:/home/robot/src/Real-Time-Face-Expression-Recognition
            - /tmp/.X11-unix:/tmp/.X11-unix:rw    
        entrypoint:
            - bash
            - -ci
            - "python3 stage_fer.py --server -modelname fer"        
    
    persondetection:
        image: nicodman/thesis:persondetection
        container_name: persondetection_container
        dns: 8.8.8.8
        network_mode: "host"
        stdin_open: true #docker run -i
        tty: true               #docker run -t
        environment:
            - DISPLAY=:0
        privileged: true
        devices:
            - /dev/video0:/dev/video0
        volumes:
            - $SPD_DIR/models/Person-Detection-and-Tracking:/home/robot/src/Person-Detection-and-Tracking
            - /tmp/.X11-unix:/tmp/.X11-unix:rw            
        entrypoint:
            - bash
            - -ci
            - "python3 stage_pd.py --server"